/*
Title: 断线重连
Sort: 25
*/

# 断线重连

Matchvs 提供了断线重连的功能：当客户端网络异常（包含网络关闭、弱网络、挂起至后台等情况），此时可以调用SDK reconnect()接口进行重连。网络异常时应用层会收到“检测到客户端已经断线的`errorResponse` 错误码1001。如果调用重连成功，断线的用户将会回到原来的游戏房间；如果重连失败，应用层会收到“重连失败”。

重连频次 ： 每调用一次`reconnect()`会尝试重连一次，即从检测到断开开始，重连尝试20秒如果还没有重连成功，则会抛出失败消息。



![](http://imgs.matchvs.com/static/reconnect4.png)  



如果服务端检测到客户端网络异常，则服务端会通过`networkStateNotify`告诉其他客户端“检测到客户端C已断线，正在进行重连”。如果重连成功，服务端会通知其他客户端“客户端C已经重连成功”；如果重连失败，服务端会通知其他客户端“客户端C重连失败”。

![](http://imgs.matchvs.com/static/reconnect2.png)

## 接口使用

玩家断线20秒内可调用reconnect接口重连到原来房间，无论房间处于哪一种状态都可以连上。重连回房间使用方式有两种。

```
1、玩家断开20秒内马上 reconnect。
2、玩家断开后回到登录界面重新登录，loginResponse 返回参数 roomID 不为0 代表可以重新连接。这个时候调用reconnect 重连回房间。
```

> 注意：玩家断开后马上重连，不能写在 errorResponse 中，这样可能会出现无限重连的情况。最好是使用按钮，或者设置重连次数和重连触发时间。



